<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>test</title>
</head>
<body>


<script>

var XHR = function() {
    var standard = {
        createXHR : function() {
            return new XMLHttpRequest();
        }
    }
    var newActionXObject = {
        createXHR : function() {
            return new ActionXObject("Msxml2.XMLHTTP");
        }
    }
    var oldActionXObject = {
        createXHR : function() {
            return new ActionXObject("Microsoft.XMLHTTP");
        }
    }
    if(standard.createXHR()) {
        return standard;
    } else {
        try {
            newActionXObject.createXHR();
            return newActionXObject;
        } catch(o) {
            oldActionXObject.createXHR();
            return oldActionXObject;
        }
    }
}();


var xhr = XHR.createXHR();	//创建XMLHttpRequest实例对象




</script>



</body>
</html>
